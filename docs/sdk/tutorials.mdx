---
sidebar_position: 4
---

# Tutorials

This short tutorial will explore how to integrate install and use Reachus SDKs
main operations, from fetching products to initiate a checkout. We will use
Reachus SDK to load our data using the Reachu API and enable the payment
solution.

## Requirements

To follow this tutorial, there are the following requirements:

- Basic understanding of React and TypeScript
- Node, yarn (or npm) installed
- An account on the [Reachu platform](https://www.reachu.io/)

:::info

This tutorial is intended to initiate a new project from scratch and showcase
all sdk funcionalities. Additional styling or frontend interactions will not be
covered.

:::

## Setup the project

Let's start by creating a new
[React application](https://reactjs.org/docs/create-a-new-react-app.html).

```shell
npx create-react-app my-app
cd my-app
```

Next, we need to install the Reachu SDK

```shell
npm i @reachu/sdk
```

Then, let's start the development server

```shell
npm start
```

## Connecting to Reachu

Now that we kickstarted our project, we need to create a connection to Reachu
and enable the store solution.

To initialize the connection, go to src/, create a new file reachu-sdk.ts and
add the following code.

```js
import { SdkClient } from '@outshifterdev/sdk';

let sdk;
export function getSDK() {
  if (!sdk) sdk = new SdkClient('YOUR_API_KEY', 'https://api.reachu.io');

  return sdk;
}
```

This function will do mainly two things: Initialize the connection with Reachu
(enabling the SDK and the checkout solution) and provide an API client that we
can use to retrieve content from the platform, to be used in our application.

You can get the API Key from the Reachu platform:

- Go to the channels tab and click on the "+ Add a Channel" button
- Choose the API channel, click on the "Add" button
- Click on the "Create" button under the API key section and copy it
- Create the channel by clicking on the "Create API Channel" button

![screenshot-channel-add](/static/sdk/tutorial-channel-add.png)

![screenshot-channel-apikey](/static/sdk/tutorial-channel-apikey.png)

## Styling

Letâ€™s add [TailwindCSS](https://tailwindcss.com) to our project for the ease of
adding styles. You can refer to this
[guide](https://tailwindcss.com/docs/installation) for adding TailwindCSS to
Gatsby.js.

## Get products

You can now start to import products to your API channel.

- Go to the Channels tab in the main menu
- Click on the "Manage" button on your channel
- Click on the "Add items" button

You have 3 ways of importing products to your channel:

- Add your own listings you previosly created or imported from your store
- Add your own collection you previously created or imported from your store
- Add a shared collection from a merchant

:::info

Find [here](/platform/tutorials) how to add products in any of the three
previously mentioned ways. The last option is the most common one since as a
sales channel you will probably be working with different suppliers.

:::

Asumming you have imported products or collections to your channel, the section
on the platform should look something like this:

![screenshot-channel-products](/static/sdk/tutorial-channel-products.png)

Let's begin fetching products on your project using the SDK. Create a new folder
src/components/ and a new file DisplayProducts.js:

```js
import { useState, useEffect } from 'react';
import { getSDK } from '../reachu-sdk.js';

const DisplayProducts = () => {
  const [products, setProducts] = useState([]);
  const ProductChannelId = 8;

  useEffect(() => {
    const fetchProducts = async () => {
      const sdk = getSDK();
      const response = await sdk.channel.item.getAll(ProductChannelId);
      setProducts(response);
    };
    fetchProducts();
  });

  return (
    <>
      <h1 className="mt-10 mb-12 text-5xl font-bold">Products</h1>
      <div className="mx-auto max-w-screen-xl">
        <div className="grid grid-cols-6 gap-6">
          {products.map((product) => (
            <div>
              <img src={product.images[0].url} alt={product.title} />
              <div className="mt-2">
                <span className="block font-semibold">{product.title}</span>
                <div>
                  <span className="pr-2">{product.price.currencyCode}</span>
                  <span>{product.price.amount}</span>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </>
  );
};

export default DisplayProducts;
```

You can import the DisplayProducts component on the homepage:

```js
import './App.css';
import DisplayProducts from './components/DisplayProducts';

function App() {
  return (
    <div className="App">
      <main>
        <DisplayProducts />
      </main>
    </div>
  );
}

export default App;
```

Nice! Your products should be diplaying in the home page and should look
something like this:

![screenshot-product-alll](/static/sdk/tutorial-product-all.png)

## Interacting with the cart

### Create and get the cart

We will start by creating the cart when the user lands to our page, but we do
not want to create it each time, so first we need to check if it was previously
created.

- If it doesnt exist we will create it and save the id on the localstorage to
  fetch it again if the user refreshes the page, but feel free to use a
  different method but for the tutorial purposes we will use this way.

- For hadeling states, we will just create a cart state on the main App.jsx
  file, but here you may use context or any other solution you find more
  suitable.

Create a new file src/components/DisplayCart.js:

```js
import { useEffect } from 'react';
import { getSDK } from '../reachu-sdk';

const CartItem = ({ item }) => (
  <div className="flex flex-row items-center space-x-12 py-4">
    <img
      className="h-20 w-16 rounded object-cover"
      src={item.product_image?.[0]?.url}
    />
    <div className="flex flex-1 flex-col text-left">
      <div className="text-lg">{item.product_title}</div>
    </div>
    <div className="font-bold">
      {item.price_data.unit_price} {item.price_data.currency}
    </div>
  </div>
);

const DisplayCart = ({ cart, setCart }) => {
  const cartLength = cart?.line_items.length;

  useEffect(() => {
    const fetchCart = async () => {
      const sdk = getSDK();
      const cartId = localStorage.getItem('reachu-cart-id');
      if (cartId) {
        const cart = await sdk.shopCart.cart.getById(cartId);
        if (cart) return setCart(cart);
      } else {
        let newCart = await sdk.shopCart.cart.create({
          currency: 'EUR',
          customer_session_id: Math.floor(Math.random() * 1000000).toString(),
        });
        localStorage.setItem('reachu-cart-id', newCart.cart_id);
        if (newCart) return setCart(newCart);
      }
    };
    fetchCart();
  }, []);

  return (
    <>
      <h2 className="mt-10 mb-12 text-5xl font-bold">
        Cart
        {cartLength > 0 && <span> ({cartLength})</span>}
      </h2>
      {cart?.line_items.map((item) => (
        <CartItem item={item} key={item.id} />
      ))}
      {cartLength < 1 ? (
        <p>Your cart is empty.</p>
      ) : (
        <div className="mt-12 border-t border-black">
          <div className="mt-6 flex flex-row items-center justify-between py-4">
            <span>Total moms:</span>
            <div className="text-xl font-bold">333 {cart?.currency}</div>
          </div>
          <div className="items-cente flex flex-row justify-between py-4 font-bold">
            <span className="text-2xl">Total gyt6x5x</span>
            <div className="text-3xl">
              {cart?.total_amount} {cart?.currency}
            </div>
          </div>
          <button className="mt-6 w-full rounded-lg bg-black px-3 py-3 text-white">
            Proceed to Checkout
          </button>
        </div>
      )}
    </>
  );
};

export default DisplayCart;
```

On the App.jsx file:

```js
import './App.css';

import DisplayProducts from './components/DisplayProducts';
import DisplayCart from './components/DisplayCart';

function App() {
  return (
    <div className="App">
      <header className="App-header"></header>
      <main>
        <div className="grid grid-cols-4">
          <div className="col-start-1 col-end-4">
            <DisplayProducts />
          </div>
          <div className="col-span-1 col-end-5 h-screen border-l border-black">
            <DisplayCart />
          </div>
        </div>
      </main>
    </div>
  );
}

export default App;
```

Since we have not added any product yet, the cart is showing as empty:

![screenshot-product-alll](/static/sdk/tutorial-product-all.png)

### Add products to the cart

We are need to add an "Add to Cart" button to start the cart interaction.

When a user clicks on the "Add to Cart" button they begin to see the cart fulled
of items:

![screenshot-cart-add-item](/static/sdk/tutorial-cart-add-item.png)

On the DisplayProducts.jsx file:

```js
...
  const handleAddToCart = async (product) => {
    const sdk = getSDK();
    const response = await sdk.shopCart.cartItem.create({
      cartId: cart.cart_id,
      line_items: [
        {
          product_id: product.id,
          quantity: 1,
          variant_id: null,
          price_data: {
            currency: product.price.currencyCode,
            tax: 25,
            unit_price: Number(product.price.amount),
          },
        },
      ],
    });
    setCart({ ...cart, line_items: response.line_items });
  }
...
  {products?.map(product => (
    <div key={product.id}>
      <img src={product.images[0].url} alt={product.title} />
      <div className="mt-2 text-center">
        <span className="block font-semibold">{product.title}</span>
        <div className="mb-3">
          <span className="pr-2">{product.price.currencyCode}</span>
          <span>{product.price.amount}</span>
        </div>
        <button
          className="block mx-auto bg-black text-white px-3 py-3 rounded-lg w-full"
          onClick={() => handleAddToCart(product)}
        >
          Add to Cart
        </button>
      </div>
    </div>
  ))}
...
```

### Update quantity or remove products

We will handle both directly with the quantity, adding an add and a remove
button next to it.

![screenshot-cart-update-remove-item](/static/sdk/tutorial-cart-update-remove-item.png)

We update the CartItem function:

```js
const CartItem = ({ cart, setCart, item }) => {
  const isOneItem = item.quantity === 1;

  const handleRemoveFromCart = async () => {
    const sdk = getSDK();
    const response = await sdk.shopCart.cartItem.delete(cart.cart_id, item.id);
    setCart({ ...cart, line_items: response.line_items });
  };

  const handleUpdateCart = async (qty) => {
    const sdk = getSDK();
    const response = await sdk.shopCart.cartItem.update(cart.cart_id, item.id, {
      qty,
    });
    setCart({ ...cart, line_items: response.line_items });
  };

  return (
    <div className="flex flex-row items-center space-x-3 py-4">
      <img
        className="h-20 w-16 rounded object-cover"
        src={item.product_image?.[0]?.url}
      />
      <div className="flex flex-1 flex-col text-left">
        <div className="text-lg">{item.product_title}</div>
        <div className="pt-3 font-bold">
          <button
            className="h-8 w-8 rounded-full border border-black pb-0.5"
            onClick={() =>
              isOneItem
                ? handleRemoveFromCart()
                : handleUpdateCart(item.quantity - 1)
            }
          >
            {isOneItem ? 'x' : '-'}
          </button>
          <span className="px-2">{item.quantity}</span>
          <button
            className="h-8 w-8 rounded-full border border-black pb-0.5"
            onClick={() => handleUpdateCart(item.quantity + 1)}
          >
            +
          </button>
        </div>
      </div>
      <div className="font-bold">
        {item.price_data.unit_price} {item.price_data.currency}
      </div>
    </div>
  );
};
```

## Interacting with the checkout

### Create and get the checkout

For the creation or fetching of the checkout, we will mimicate the way we do it
with the cart. When the customer clicks on the "Proceed to Checkout" button, we
will create the checkout if not previously created or fetch it if we see it
stored on the local storage.

Also, if the checkout is initiated, instead of the products, we will display the
checkout, and keep on the sidebar the products list and order amounts.

On the App.jsx we will add:

```js
...
  const [checkout, setCheckout] = useState(null);

  const handleCreateCheckout = async () => {
    const sdk = getSDK();
    const checkoutId = localStorage.getItem("reachu-checkout-id");
    if (checkoutId) {
        const response = await sdk.shopCart.checkout.getById(checkoutId);
        if (response) return setCheckout(response);
    } else {
        const response = await sdk.shopCart.checkout.create({
            cart_id: cart.cart_id,
        });
        localStorage.setItem("reachu-checkout-id", response.id);
        if (response) return setCheckout(response);
    }
  }
  ...
  <main>
    <div className="grid grid-cols-4">
      <div className="col-start-1 col-end-4 px-6 pb-20">
      {checkout ? (
        <DisplayCheckout
          checkout={checkout}
        />
      ) : (
        <DisplayProducts
          cart={cart}
          setCart={setCart}
        />
      )}
      </div>
      <div className="col-end-5 col-span-1 h-screen border-l border-black px-6">
        <DisplayCart
          cart={cart}
          setCart={setCart}
          checkout={checkout}
          handleCreateCheckout={handleCreateCheckout}
        />
      </div>
    </div>
  </main>
  ...
```

### Update the checkout

This is an optional step, but we recomend that the first step of the checkout is
to store the email of the potencial buyer. This way you can reach them if the
checkout is abandoned before proceeding to payment.

We can create a small form to complete this and the next steps.

![tutorial-checkout-customer-info](/static/sdk/tutorial-checkout-customer-info.png)

```js
const DisplayCheckout = ({ checkout, setCheckout }) => {
  const handleUpdateCheckout = async (body) => {
    const sdk = getSDK();
    const response = await sdk.shopCart.checkout.update(checkout.id, body);
    console.log(response);
    if (response) setCheckout(response);
  };

  return (
    <>
      <h2 className="mt-10 mb-12 text-5xl font-bold">Checkout</h2>
      <div className="mx-auto max-w-screen-lg">
        <h3 className="mt-10 mb-12 text-3xl font-bold">Customer Information</h3>
        <FormInfo handleUpdateCheckout={handleUpdateCheckout} />
      </div>
    </>
  );
};
```

```js
import { useState } from 'react';
import Button from '../../common/Button';
import FormField from '../../common/FormField';

const FormInfo = ({ checkout, handleUpdateCheckout }) => {
  const [valid, setValid] = useState(false);

  return (
    <form
      onChange={(e) => {
        setValid(e.currentTarget.checkValidity());
      }}
      className="flex h-full flex-col"
      onSubmit={(e) => {
        e.preventDefault();
        const data = new FormData(e.currentTarget);
        const formFields = [
          'email',
          'phone_code',
          'phone',
          'first_name',
          'last_name',
        ];
        const values = formFields.reduce(
          (acc, field) => ({ ...acc, [field]: data.get(field) }),
          {}
        );
        const body = {
          email: values.email,
          billing_address: {
            first_name: values.first_name,
            last_name: values.last_name,
            phone_code: values.phone_code,
            phone: values.phone,
          },
          shipping_address: {
            first_name: values.first_name,
            last_name: values.last_name,
            phone_code: values.phone_code,
            phone: values.phone,
          },
        };
        handleUpdateCheckout(body);
      }}
    >
      <div className="flex-1 overflow-y-auto">
        <div className="grid grid-cols-2 gap-6 pb-6">
          <FormField
            label="E-mail"
            name="email"
            defaultValue={checkout?.email || ''}
            type="email"
            autoComplete="email"
            autoFocus
            required
          />
          <div className="flex">
            <FormField
              label="Phone Code"
              name="phone_code"
              defaultValue={checkout?.billing_address?.phone_code || ''}
              type="number"
              autoComplete="phone_code"
              autoFocus
              required
            />
            <FormField
              label="Phone Number"
              name="phone"
              defaultValue={checkout?.billing_address?.phone || ''}
              type="number"
              className="w-full"
              autoComplete="phone"
              autoFocus
              required
            />
          </div>
          <FormField
            label="First Name"
            name="first_name"
            defaultValue={checkout?.billing_address?.first_name || ''}
            required
            autoComplete="given-name"
          />
          <FormField
            label="Last Name"
            name="last_name"
            defaultValue={checkout?.billing_address?.last_name || ''}
            required
            autoComplete="family-name"
          />
        </div>
      </div>
      <div className="block flex-row pt-4">
        <Button type="submit" disabled={!valid} className="mx-auto w-52">
          <div className="flex-1 text-center">Save</div>
        </Button>
      </div>
    </form>
  );
};

export default FormInfo;
```

### Shipping

Each product may have different shipment options as they may come from different
suppliers. Before initiating the payment, a shipment for each product must be
confirmed.

Once the customer confirms the shipping id, we will add the confirmed shipping
id to the item in the cart.

In the checkout object we find a shipping parameter with the total shipping
calculated.

![screenshot-checkout-shipping](/static/sdk/tutorial-checkout-shipping.png)

```js
import { useState, useEffect } from 'react';
import { getSDK } from '../../../reachu-sdk';

import Button from '../../common/Button';

const ShippingItem = ({ item, cartId }) => {
  const [shipping, setShipping] = useState(null);
  const [value, setValue] = useState(null);

  useEffect(() => {
    const fetchShipping = async () => {
      const sdk = getSDK();
      const response = await sdk.shopCart.shipping.getShippingByProductId(
        item.product_id
      );
      setValue(response[0].id);
      setShipping(response);
    };
    fetchShipping();
  }, []);

  const onChange = (e) => {
    const shippingId = e.target.value;
    setValue(shippingId);
  };

  const handleUpdateShipping = async () => {
    const sdk = getSDK();
    await sdk.shopCart.cartItem.update(cartId, item.id, { shippingId: value });
  };

  return (
    <div className="mb-3">
      <div className="grid grid-cols-2 items-center">
        <div className="grid grid-cols-4">
          <span className="col-span-2">{item.product_title}</span>
          <span>{item.quantity}</span>
          <span>
            {item.price_data?.currency} {item.price_data?.unit_price}
          </span>
        </div>
        <div className="flex">
          <select
            name="shipping"
            placeholder="Shipping"
            className="mr-3 block w-full border border-gray-900 bg-white py-2 px-3 shadow-sm focus:border-indigo-500 focus:outline-none focus:ring-indigo-500 sm:text-sm"
            value={value}
            onChange={onChange}
          >
            {shipping?.map(
              ({ id, name, description, currencyCode, amount }) => (
                <option key={id} value={id}>
                  {name} -- {description} -- {currencyCode} {amount}
                </option>
              )
            )}
          </select>
          <Button onClick={handleUpdateShipping}>Set</Button>
        </div>
      </div>
    </div>
  );
};

const FormShipping = ({ checkout }) => {
  return (
    <div className="flex-1 overflow-y-auto">
      <div>
        <div className="grid grid-cols-2">
          <div className="grid grid-cols-4 pb-6 font-bold">
            <span className="col-span-2">Title</span>
            <span>Quantity</span>
            <span>Price</span>
          </div>
        </div>
        <div></div>
        {checkout?.cart?.line_items?.map((item) => (
          <ShippingItem
            item={item}
            key={item.id}
            cartId={checkout.cart.cart_id}
          />
        ))}
      </div>
    </div>
  );
};

export default FormShipping;
```

### Payment

In the checkout object you will have the information of the available payment
methods for your user:

```json
"availablePaymentMethods": [
  {
    "name": "Stripe"
  },
  {
    "name": "Klarna"
  }
]
```

### Payment

For Klarna we already have all information and we can initiate payment:

![screenshot-checkout-klarna-1](/static/sdk/tutorial-checkout-klarna-1.png)
![screenshot-checkout-klarna-1](/static/sdk/tutorial-checkout-klarna-2.png)
